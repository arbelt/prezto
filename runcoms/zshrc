#
# Executes commands at the start of an interactive session.
#
# Authors:
#   Sorin Ionescu <sorin.ionescu@gmail.com>
#

# Source Prezto.
if [[ -s "${ZDOTDIR:-$HOME}/.zprezto/init.zsh" ]]; then
  source "${ZDOTDIR:-$HOME}/.zprezto/init.zsh"
fi

# Customize to your needs...

if [[ "$(uname)" = "Darwin" ]]; then
    # virtualenv setup
    virtualenv_wrapper_init="/usr/local/bin/virtualenvwrapper.sh"
    export WORKON_HOME="$HOME/Envs"

    # gpg-apent setup
    if [ -f "${HOME}/.gpg-agent-info" ]; then
        . "${HOME}/.gpg-agent-info"
        export GPG_AGENT_INFO
    else
        eval "$(gpg-agent --daemon --write-env-file)"
    fi

    unalias run-help
    autoload run-help
    HELPDIR=/usr/local/share/zsh/helpfiles
else
    virtualenv_wrapper_init="/usr/bin/virtualenvwrapper.sh"
fi

[[ -f "$virtualenv_wrapper_init" ]] && source "$virtualenv_wrapper_init"

#scm_breeze

if [[ -s "${HOME}/.scm_breeze/scm_breeze.sh" ]]; then
    source "${HOME}/.scm_breeze/scm_breeze.sh"
fi

# fasd

if command -v fasd >/dev/null 2>&1; then
    eval "$(fasd --init auto)"
fi

# perlbrew

if [[ -s "${HOME}/perl5/perlbrew/etc/bashrc" ]]; then
    source "${HOME}/perl5/perlbrew/etc/bashrc"
fi

# rbenv

if [[ -d "/usr/local/var/rbenv" ]]; then
    export RBENV_ROOT=/usr/local/var/rbenv
    eval "$(rbenv init -)"
fi

if command -v npm >/dev/null 2>&1; then
    eval "$(npm completion)"
fi

# nvm

if [[ -s "${HOME}/.nvm/nvm.sh" ]]; then
    source "${HOME}/.nvm/nvm.sh"
fi

use_macports() {
    typeset -gU path
    path=(
	/opt/local/{bin,sbin}
	$path
    )
    export path
}

use_conda() {
    typeset -gU path
    if [[ -d "$HOME/anaconda/bin" ]]; then
	path=(
	    "${HOME}/anaconda/bin"
	    $path
	)
	export path
    else
	echo "Anaconda installation not found!"
	return 1
    fi
}

use_epd() {
    epd_env="$HOME/Library/Enthought/Canopy_64bit/User/bin/activate"
    if [[ -f "$epd_env" ]]; then
	source "$epd_env"
    else
	echo "Enthought not found!"
	return 1
    fi
}
